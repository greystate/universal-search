<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>Universal Search</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<style>
	html { color-scheme: light dark; }
	body { font-family: ui-sans-serif, sans-serif; }
	main {
		max-inline-size: 1400px;
		margin-inline: auto;
		display: flex; justify-content: start; flex-wrap: wrap; gap: 10px;
		display: grid; grid-template-columns: repeat(auto-fit, minmax(26ch, 1fr));
	}
	h1 { text-align: center; }
	article { display: flex; flex-direction: column; border-radius: 0.2em; background: #ccc8; border: 1px solid #ddd; padding: 1em; }
	form { display: flex; flex-direction: column; gap: 10px; flex: 1; }
	input[type="text"], input[type="search"], input[type="password"] { border: 1px solid #9998; border-radius: 2px; font-size: 1rem; padding: 0.25rem 0.8rem; margin: 0; }
	button { font-size: 1.2rem; border: 2px solid #999; padding: 0.3em 1.2em; border-radius: 3px; }
	fieldset { display: inline-block; }
	.submission { display: flex; justify-content: flex-end; margin-block-start: auto; }
	.actions { display: flex; justify-content: center; gap: 10px; margin-block-start: 1rem; }
	</style>
</head>
<body>
<h1>Universal Search Page</h1>
<main>
	<article id="search-imdb">
		<header><h2>IMDb</h2></header>

		<form action="https://imdb.com/find" method="get" target="_blank">
			<label for="imdb-q">Search query</label>
			<input name="q" type="search" placeholder="E.g. 'star wars'" id="imdb-q">

			<fieldset>
				<legend>Search type</legend>
				<div>
					<input type="radio" name="s" value="tt" id="s-tt" checked>
					<label for="s-tt">Titles</label>
				</div>
				<div>
					<input type="radio" name="s" value="nm" id="s-nm">
					<label for="s-nm">Names</label>
				</div>
				<hr>
				<div>
					<input type="checkbox" name="exact" value="true" id="exact-true">
					<label for="exact-true">Show exact matches only</label>
				</div>
			</fieldset>

			<p class="submission">
				<button type="submit">Search</button>
			</p>
		</form>
	</article>

	<article id="search-playpilot">
		<header><h2>PlayPilot</h2></header>

		<form action="https://www.playpilot.com/dk/search/" method="get" target="_blank">
			<label for="playpilot-q">Search query</label>
			<input name="q" type="search" placeholder="E.g. 'the prestige'" id="playpilot-q">

			<p class="submission">
				<button type="submit">Search</button>
			</p>
		</form>
	</article>

	<article id="search-caniuse">
		<header><h2>Can I Use?</h2></header>

		<form action="https://caniuse.com/" method="get" target="_blank">
			<label for="caniuse-q">Search query</label>
			<input name="search" type="search" placeholder="E.g. 'padding-inline'" id="caniuse-q">

			<p class="submission">
				<button type="submit">Search</button>
			</p>
		</form>
	</article>

	<article id="search-omdb">
		<header><h2>OMDb API</h2></header>

		<form action="https://www.omdbapi.com/" method="get" target="_blank">
			<label for="omdb-t">Title search</label>
			<input name="t" type="search" placeholder="E.g. 'gravity'" id="omdb-t">
			<input type="hidden" name="r" value="xml">

			<details>
				<summary>API</summary>
				<label for="apikey">Key</label>
				<input type="password" id="apikey" name="apikey" value="" data-allow-storage="yes">
			</details>

			<p class="submission">
				<button type="submit">Search</button>
			</p>
		</form>
	</article>

	<article id="search-tmdb">
		<header><h2>TMDb API</h2></header>

		<form action="https://api.themoviedb.org/3/search/movie/" method="get" target="_blank">
			<label for="tmdb-query">Title search</label>
			<input name="query" type="search" placeholder="E.g. 'gravity'" id="tmdb-query">

			<details>
				<summary>API</summary>
				<label for="api_key">API Key</label>
				<input type="password" id="api_key" name="api_key" value="" data-allow-storage="yes">
			</details>

			<p class="submission">
				<button type="submit">Search</button>
			</p>
		</form>
	</article>

</main>

<div class="actions">
	<button type="button" onclick="loadKeys()">Load API keys</button>
	<button type="button" onclick="saveKeys()">Save API keys</button>
</div>

<script>
window.__STORAGEMOCK = {}
function getVault() {
	if ('localStorage' in window) {
		return localStorage
	} else {
		return {
			getItem: function(key) { return window.__STORAGEMOCK[key] },
			setItem: function(key, value) { window.__STORAGEMOCK[key] = value }
		}
	}
}

function loadKeys() {
	const vault = getVault()
	const dataString = vault.getItem('apiKeys')
	const data = JSON.parse(dataString)
	if (data != null && data.length > 0) {
		data.forEach(item => {
			let element = document.getElementById(item.id)
			if (element) {
				element.value = item.value
			}
		})
	}
}

function saveKeys() {
	const vault = getVault()
	let data = []
	let storables = document.querySelectorAll('[data-allow-storage="yes"]')
	storables.forEach(s => {
		let item = { id: s.id, value: s.value }
		data.push(item)
	})
	vault.setItem('apiKeys', JSON.stringify(data))
}
</script>

</body>
</html>
